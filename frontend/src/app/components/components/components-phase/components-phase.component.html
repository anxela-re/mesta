<div
  class="m-2 p-2 border-2 border-dashed rounded-xl"
  [ngStyle]="{ 'border-color': phase?.color }"
>
  <div
    class="px-2 flex justify-between hover:opacity-60 cursor-pointer"
    (click)="open = !open"
  >
    <h4
      class="tracking-widest uppercase font-semibold"
      [ngStyle]="{ color: phase?.color }"
    >
      {{ phase?.name }}
    </h4>
    <div class="flex">
      <span
        *ngIf="!fromFormulation && !fromRecipeDetails"
        class="px-1"
        [ngStyle]="{ color: phase?.color }"
        >{{ components.length }} componentes</span
      >
      <span
        *ngIf="fromFormulation || fromRecipeDetails"
        class="px-1"
        [ngStyle]="{ color: phase?.color }"
        >{{ percentage }}%</span
      >
      <fa-icon
        [icon]="open ? faChevronUp : faChevronDown"
        [ngStyle]="{ color: phase?.color }"
      ></fa-icon>
    </div>
  </div>
  <div class="flex-col" [ngClass]="{ hidden: !open, flex: open }">
    <div *ngIf="phaseComponentsForm?.errors?.maxAddition" class="text-xs font-bold">
      El porcentage de los componentes no debe superar al total asignado en la
      composici√≥n
    </div>
    <div class="flex-wrap">
      <ng-container *ngFor="let component of components">
        <app-component-item
          [component]="component"
          *ngIf="component.phase_id === phase?.id"
          [fromFormulation]="fromFormulation"
          [fromRecipeDetails]="fromRecipeDetails"
          (onPercentageChange)="onPercentageChange($event)"
        ></app-component-item
      ></ng-container>
    </div>
  </div>
</div>

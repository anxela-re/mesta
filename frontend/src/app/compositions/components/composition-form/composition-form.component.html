<form
  [formGroup]="compositionForm"
  (ngSubmit)="onSubmit()"
  class="bg-white-700 border-2 border-dashed border-secondary-100 rounded-lg p-2 max-w-[300px]"
>
  <div class="my-2">
    <div class="flex gap-2 flex-col">
      <label for="name">Nombre</label>
      <input
        type="text"
        [formControl]="name"
        class="light-input"
        placeholder="Nombre"
      />
    </div>
    <div
      *ngIf="name?.errors && (name?.touched || name?.dirty)"
      class="form-errors"
    >
      <div *ngIf="name?.errors?.required">Obligatorio</div>
      <div *ngIf="name?.errors?.maxlength">
        Name can be max 64 characters long.
      </div>
    </div>
  </div>
  <div class="my-2 flex flex-col" formArrayName="phasesPercentage">
    <div
      class="m-2"
      *ngFor="let phaseForm of phasesPercentage.controls; let i = index"
    >
      <div [formGroupName]="i">
        <div class="flex gap-1 justify-between">
          <label for="percentage">{{ phasesPercentageNameByIndex(i) }}</label>
          <div class="flex">
            <input
              type="number"
              min="0"
              max="100"
              formControlName="percentage"
              class="light-input w-[100px]"
            />
            <span>%</span>
          </div>
        </div>
      </div>
    </div>
    <div
      *ngIf="phasesPercentage?.errors && (phasesPercentage?.touched || phasesPercentage?.dirty)"
      class="form-errors"
    >
      <div
        *ngIf="phasesPercentage.errors?.additionValidator"
        class="form-errors text-wrap"
      >
        La suma actual es de {{phasesPercentage.errors?.additionValidator}}, debe ser igual 100
      </div>
    </div>
  </div>
  <div class="flex justify-around">
    <button
      type="submit"
      class="btn btn-primary disabled:cursor-default disabled:bg-primary-300"
      [disabled]="!compositionForm.valid"
    >
      AÃ±adir
    </button>
    <button type="button" class="btn btn-secondary">Cancelar</button>
  </div>
</form>
